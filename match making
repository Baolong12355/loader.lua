-- ‚úÖ Auto Join Map - TDX (ho√†n ch·ªânh & d√πng v·ªõi loader) -- T·ª± ƒë·ªông d·ªãch chuy·ªÉn v√†o map, ki·ªÉm tra ng∆∞·ªùi ch∆°i v√† t√≠ch h·ª£p v·ªõi TDX_Config

local Players = game:GetService("Players") local ReplicatedStorage = game:GetService("ReplicatedStorage") local Workspace = game:GetService("Workspace")

local LocalPlayer = Players.LocalPlayer local config = getgenv().TDX_Config or {} local targetMapName = config["Map"] or "HAKUREI SHRINE" local expectedPlaceId = 9503261072 -- lobby TDX

-- Ki·ªÉm tra c√≥ ƒëang ·ªü ƒë√∫ng lobby TDX kh√¥ng local function isInLobby() return game.PlaceId == expectedPlaceId end

-- So s√°nh t√™n map m·ªÅm local function matchMap(a, b) return (a or ""):lower():gsub("%s+", "") == (b or ""):lower():gsub("%s+", "") end

-- D·ªãch chuy·ªÉn ch√≠nh x√°c ƒë·∫øn Detector local function enterDetectorExact(detector) local char = LocalPlayer.Character local hrp = char and char:FindFirstChild("HumanoidRootPart") if hrp then hrp.CFrame = detector.CFrame end end

-- X·ª≠ l√Ω v√†o map n·∫øu h·ª£p l·ªá local function tryEnterMap() if not isInLobby() then warn("‚õî ƒê√£ r·ªùi kh·ªèi lobby TDX. D·ª´ng script.") return false end

local LeaveQueue = ReplicatedStorage:FindFirstChild("Network") and ReplicatedStorage.Network:FindFirstChild("LeaveQueue")
local roots = {Workspace:FindFirstChild("APCs"), Workspace:FindFirstChild("APCs2")}

for _, root in ipairs(roots) do
    if root then
        for _, folder in ipairs(root:GetChildren()) do
            if folder:IsA("Folder") then
                local apc = folder:FindFirstChild("APC")
                local detector = apc and apc:FindFirstChild("Detector")

                local mapDisplay = folder:FindFirstChild("mapdisplay")
                local screen = mapDisplay and mapDisplay:FindFirstChild("screen")
                local displayscreen = screen and screen:FindFirstChild("displayscreen")
                local mapLabel = displayscreen and displayscreen:FindFirstChild("map")
                local plrCountLabel = displayscreen and displayscreen:FindFirstChild("plrcount")

                if detector and mapLabel and plrCountLabel then
                    if matchMap(mapLabel.Text, targetMapName) then
                        local countText = plrCountLabel.Text or ""
                        local cur, max = countText:match("(%d+)%s*/%s*(%d+)")
                        cur, max = tonumber(cur), tonumber(max)

                        if cur == 0 and max == 4 then
                            print("‚úÖ V√†o map:", mapLabel.Text)
                            enterDetectorExact(detector)
                            return true
                        elseif cur >= 2 and max == 4 and LeaveQueue then
                            print("‚ùå Map ƒë√£ c√≥ nhi·ªÅu ng∆∞·ªùi:", cur .. "/" .. max, "‚Üí Tho√°t queue")
                            pcall(function()
                                LeaveQueue:FireServer()
                            end)
                            task.wait(1)
                        else
                            print("‚ö†Ô∏è Kh√¥ng v√†o. Tr·∫°ng th√°i hi·ªán t·∫°i:", cur .. "/" .. max)
                        end
                    end
                end
            end
        end
    end
end

return true -- ti·∫øp t·ª•c l·∫∑p

end

-- V√≤ng l·∫∑p ch·∫°y ƒë·∫øn khi r·ªùi kh·ªèi lobby while isInLobby() do local ok, continue = pcall(tryEnterMap) if not ok then warn("‚ùå L·ªói:", continue) elseif not continue then break end task.wait(1) end

warn("üì§ Script ƒë√£ d·ª´ng (r·ªùi lobby ho·∫∑c k·∫øt th√∫c).")

